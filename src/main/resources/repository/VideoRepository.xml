<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mdd.ela.repository.VideoRepository">
    <resultMap id="video" type="com.mdd.ela.dto.model.Video">
        <result column="id" property="id"/>
        <result column="course_id" property="courseId"/>
        <result column="chapter_num" property="chapterNum"/>
        <result column="video_title" property="videoTitle"/>
        <result column="video_num" property="videoNum"/>
        <result column="video_url" property="videoUrl"/>
        <result column="video_length" property="videoLength"/>
        <result column="chapter_title" property="chapterTitle"/>
        <result column="active" property="active"/>

        <result column="create_time" property="createTime"/>
        <result column="create_user_id" property="createUserId"/>
        <result column="modify_time" property="modifyTime"/>
        <result column="modify_user_id" property="modifyUserId"/>
    </resultMap>

    <sql id="categoryTable">
        select c1.id, c1.code, c1.description from code c1 join code c2 on c1.p_id = c2.id where c2.code = 'CATEGORY'
    </sql>

    <select id="findAll" resultMap="video">
        select * from video v
        where course_id = #{courseId}
    </select>


    <select id="select" resultMap="video">
        select * from video v
        join course c on v.course_id = c.id
        where v.id = #{id}
    </select>

    <insert id="insert">
        insert into video(
        course_id
        , chapter_num
        , video_title
        , video_num
        , video_url
        , video_length
        , chapter_title
        , active
        , create_time
        , create_user_id)
        values (
        #{courseId},
        #{chapterNum},
        #{videoTitle},
        #{videoNum},
        #{videoUrl},
        #{videoLength},
        #{chapterTitle},
        #{active},
        now(),
        #{createUserId})
    </insert>


    <update id="update">
        update video
        set
        chapter_num = #{chapterNum}
        ,   video_title = #{videoTitle}
        ,   video_num = #{videoNum}
        ,   video_url = #{videoUrl}
        ,   video_length = #{videoLength}
        ,   chapter_title = #{chapterTitle}
        ,   active = #{active}
        ,   modify_time = now()
        ,   modify_user_id = #{modifyUserId}
        where id = #{id}
    </update>


    <delete id="delete">
        delete from video
        where id = #{id}
    </delete>

</mapper>